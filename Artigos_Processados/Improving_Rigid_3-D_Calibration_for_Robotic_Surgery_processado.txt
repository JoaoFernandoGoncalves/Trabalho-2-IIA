ieee transaction medical robotics bionics vol 2 4 november 2020 569 improving rigid 3d calibration robotic surgery andrea roberti nicola piccinelli graduate student member ieee daniele meli riccardo muradore member ieee paolo fiorini life fellow ieee abstract —autonomy next frontier research robotic surgery aim improve quality surgical procedure next future one fundamental requirement autonomy advanced perception capability vision sensor article propose novel calibration technique surgical scenario da vincicirclerresearch kit dvrk robot camera robotic arm calibration necessary precise position emulate expert surgeon novel calibrationtechnique tailored rgbd camera different test performed onrelevant use case prove signiﬁcantly improve precision accu racy respect state art solution similar device surgicalsize setup moreover calibration method easilyextended standard surgical endoscope used real surgical scenario index term — surgical robotics calibration multi arm calibration ntroduction signiﬁcant part current research roboticassisted minimally invasive surgery rmis focussing development autonomous system execution repetitive surgical step suturing ablation microscopic image scanning 1 thiswould potentially help surgeon could focus cognitive demanding part procedure leaving repetitive action robot autonomy requires system advanced perception reason ing motion planning highlighted 2 3 speciﬁcally bettermedical imaging vision technique signiﬁcantly improved performance robotic surgical system range clini cal scenario orthopaedics neurosurgery 4 visionsystems retrieve pre intra operative information tomog raphy ct 5 magnetic resonance mr ultrasound plan toll trajectory support surgeon ’ decision making however imageguided intervention require accurate calibration map pose robot instrument anatomy common reference frame handeye calibration widely studied within roboticsliterature 6 rmis system patientside arm areconstrained remote center motion rcm challenging obtain camera motion range needed guarantee accurate calibration wang et al 7 take advantage constraint ﬁnding unique relationship endoscope surgi cal tool using camera perspective projection geometry different approach followed 8 9 instrument themselvesare used calibration tool thus far several closedform solution 2d image proposed handeye calibration use linear method separate rotation translation 10 theorientation component derived utilizing angleaxis mulation rotation translational component estimated manuscript received july 15 2020 revised september 16 2020 october 14 2020 accepted october 19 2020 date publication october 26 2020date current version november 20 2020 article recommended forpublication associate editor elson editor dario upon evalua tion reviewer ’ comment work supported part european research council european union ’ horizon 2020research innovation programme grant 742671 ar part european union ’ horizon 2020 research innovation programme grant 779813 saras corresponding author andrea roberti author department computer science university verona 37135 verona italy email andrearobertiunivrit digital object identiﬁer 101109tmrb20203033670using standard linear system technique chou kamel 11 intro duced quaternion represent orientation solved quaternion coefﬁcients homogeneous linear least square problem closedform solution derived using generalized inverse method singular value decomposition analysis work 12–14 used kronecker product get homogeneous linear equationfor rotation matrix however separating rotational translational component neglect intrinsic correlation working directly 3d space better solution 15 author studied comparison handeye calibration basedon 2d 3d image introducing quantitative 2d 3d error metric assess calibration accuracy proved 3d calibration approach provides accurate result average butrequires burdensome manual preparation much computation time 2d approach kim used 3d measurement center marker handeye calibration 16 fuchs 17 proposed asolution based depth measurement instead 2d image using calibration plane known position orientation handeye calibration obtained estimating best ﬁtting calibrationplane measured depth value article propose novel calibration method surgi cal robotic scenario using da vinci circlerresearch kit dvrk rgbd camera differently 17 accuracy computational time method depend placement calibration board within workspace perform exhaustive experimental validation relevant use case surgery separatethe calibration robotic arm two patientside manipulator psm1 psm2 endoscope camera manipulator ecm handeye calibration camera calibrationswe propose threestep method closedform solution 1 touching reference point custom calibration board endeffectors surgical robot 2 recognizing reference point rgbd camera3 mapping pose reached robotic arm ﬁrst step 3d point computed second step main advantage proposed method improved accuracyin 3d metric space increased factor four respect stateoftheart result comparable sensor 15 moreover method camera mounted moving endoscopicarm dvrk overcoming limitation ﬁxed camera article organized follows section ii section iii describe calibration technique setup used test ourmethod section iv describe validation proposed method evaluating workspace simple kinematic task also compare calibration method tsai ’ 18 isthe gold standard handeye calibration two different tasksgrasping camera projection 3d space section present conclusion plan future work ii roposed method aim calibration procedure twofold first per form computation rigid transformation tw⋆between common reference frame world base frame arm ⋆∈ecm bpsm 1bpsm 2b second estimate transformation tcamecm camera reference frame ecm reference frame resulting transformation tree shown figure 1 work licensed creative common attribution 40 license information see httpscreativecommonsorglicensesby40 570 ieee transaction medical robotics bionics vol 2 4 november 2020 fig 1 reference frame produced proposed method ax direction reference frame visualisation purpose theorange transformation known whereas black transformation estimated fig 2 calibration component calibration board marker coloured ax represents common reference frame direction theadapter ecm positioning use custom calibration board shown figure 2a aruco marker center circumference 50 mm radius several reference dot equipped ecm 3dprinted adapter shown figure 2b adapter smaller tip theecm guarantee precise positioning dot board procedure start positioning calibration board robot workspace choose set reference point psuch point p∈pis reachable three arm visible camera point pmust symmetric respect center board compute origin common reference frame least three point needed estimate plane coefﬁcients thebest ﬁtting plane characterized centroid point set normal vector optimal estimation solution optimisation problem braceleftbigˆcˆnbracerightbig arg min cn21nsummationdisplay i1parenleftbig pi−ctnparenrightbig2 1 19 centroid estimated ˆc1 nnsummationdisplay i1pi 2 normal vector ni obtained factorizing distance matrix singular value decomposition svd ausvtbracketleftbigp1−ˆcpn−ˆcbracketrightbig ∈r3×n3and taking third column matrix ubracketleftbigu1u2u3bracketrightbig ˆnu3 generate common reference frame tool implement following three main step 1 arm calibration2 camera calibration 3 handeye calibration arm calibration ﬁnd transformation arm base frame respect common reference frame record end effector pose arm psms ecm adapter point set pi order obtain ecm effective pose remove known rigid transformation adapter ecm set estimate best ﬁtting plane using 1 set pi augmented adding point calibration board acquired moving arm ’ end effector last point used deﬁne desired plane normal direction dpn1−cvextendsinglevextendsinglepn1−cvextendsinglevextendsingle2 pn1is last point ordered set pcis centroid ofpand∗2is vector norm arm homogeneous transformation tw⋆of common reference respect arm base frame deﬁned using direction versors usignn·ndn lu×p1−c p1−c2 fl×u centroid tw ⋆⎡ ⎢⎢⎣fxlxuxcx fylyuycy fzlzuzcz 000 1⎤ ⎥⎥⎦ camera calibration ﬁnd transformation twcam rgbd camera ﬁrst detect center aruco marker board respect tothe camera frame ﬁnd camera position ensures good visibility stable pose aruco marker align pose point cloud generated depth map acquired thergbd camera use marker pose known radius generate pose every dot set pin marker reference frame well point calibration board pose set pi obtained ﬁnd best ﬁtting plane using 1 build homogeneous transformation wcam common reference frame camera base frame adapting previous approach used arm handeye calibration handeye calibration problem formulated using homo geneous transformation matrix axxb aandbare known homogeneous matrix representing frame base robot camera respectively theunknown transformation xi robot coordinate frame camera coordinate frame given twcam compute xas relative homogeneous transformation end effector ofthe ecm rgbd base frame tcam ecmtcam wparenleftbig tecm wparenrightbig−1 ieee transaction medical robotics bionics vol 2 4 november 2020 571 fig 3 proposed setup calibration realsense d435 psms calibration pattern table realsense 435 pecifications iii xperimental setup validation proposed method carried dvrk robot shown figure 3 stereo endoscope augmented intel realsense d435 rgbd camera rigidly attached endoscope 3d printed adapter camera speciﬁcations reported table whole calibration method implemented robot operatingsystem ro using point cloud library pcl opencv thepresent setup compatible surgical scenario however well possible near future small rgbd camera could integrated within endoscope iv xperimental result experimentally validate methodology compared cal ibration tsai ’ method 18 two benchmark test surgical robotics •localization grasping small target •dualarm manipulation finally evaluated accuracy projection 2d camera image plane 3d workspace localization grasping ﬁrst scenario figure 4 two psms must autonomously grasp ring placed calibration board case location 2 rgbd camera identiﬁes point cloud corresponding thering color shape segmentation point transformed camera common reference frame ring diameter 15 mm target point psms chosen asthe center ring ring placed 9 different location onthe board cover full x−yplane shown figure 4 arm reach target point ten time iteration compute euclidean distance target ﬁnal position thepsms way estimate mean accuracy calibration procedure x−yplane result reported figure 5 compared stateoftheart tsai ’ calibration method 18 itis worth mentioning error comprehensive estimated kinematic accuracy da vinci circler102 mm average fig 4 setup localization grasping experiment number calibration board represents nine location used experimentthe ring identiﬁed camera reached psms fig 5 measured 3d positioning error robot end effectorand grasping point table ii ac omparison error localization grasping test localizing reaching ﬁducial marker 20 maximum error 272 mm 21 table ii show method achieves signiﬁcantly better accuracy 0 53 mm average error 1 83 mm tsai ’ cal ibration error depend location ring thex−yplane dual arm manipulation second scenario figure 6 psms start holding ring must execute simultaneous precomputed circular trajectory center zaxis common reference frame 45 mm calibration board radius rranging 10 mm 40 mm circumference ﬁrst deﬁned x−zplane common reference frame normal calibration board replicated plane rotated around zaxis step 10 deg way deﬁne spherical workspace interpolation recorded trajectory psms commanded transformed waypoints relative frame task validates theaccuracy transformation arm computed proposed method measure difference trajectory 572 ieee transaction medical robotics bionics vol 2 4 november 2020 fig 6 dual arm manipulation experiment two arm carry ring performing circular trajectory workspace two psms consider standard maximum deviation mean radius absence calibration kinematic error difference trajectory would havenull standard deviation figure 7 show absolute error throughthe workspace sphere radius 20 mm 30 mm 40 mm using lambert equalarea cylindrical projection 22 table iii report error sphere notice mean errorincreases radius sphere psms move away calibration plane standard deviation error increase radius remains 0 11 mm hence overall error change signiﬁcantly surface sphere ensures good repeatability motion whole workspace accuracy calibration method 3d compatible requirement ofsurgery mean error arm 1 mm comparable known kinematic accuracy da vinci circler 2d3d projection last scenario psm1 colored marker tip executes spiralshaped trajectory along entire workspace thergbd camera identiﬁes marker image plane corresponding 3d point computed using depth value trajectory start near origin common reference frameand increase radius altitude according following parametric equation xtκtcosωt ytκtsinωt ztκt ωis constant angular speed κ∈ris timescaling factor orientation end effector kept ﬁxed towards camera along trajectory measure euclidean error betweenthe point trajectory executed arm reprojected point camera image plane figure 8 table iv show reprojection accuracy method signiﬁcantly outperformsthe one reached tsai ’ fact mean error 4 71 mm maximum error 11 76 mm four two time smaller one achieved tsai ’ method important remark measured error also includes marker detection accuracy finally figure 9 show reprojection psms end effector posi tion onto camera image plane calibration method method achieves better reprojection better 3d instrument onclusion article proposed novel 3d calibration procedure patientside manipulator ecm da vincicirclersurgical fig 7 absolute error dual arm manipulation workspace workspace projected using lambert equalarea cylindrical projection error reported mm workspace surface spherewith radius 10 mm projected surface sphere radius 10 mmc workspace surface sphere radius 20 mm projected surface sphere radius 20 mm workspace surface sphere radius 30 mm projected surface sphere radius30 mm workspace surface sphere radius 40 mm theprojected surface sphere radius 40 mm table iii hepositioning error psm1 psm2 uring dualarmmanipulation experiment robot procedure exploit rgbd realsense camera validated calibration procedure evaluating 2d3d projection error two relevant use case surgery localization grasping small object dualarm manipulation bothtasks require accurate estimation transformation tree con necting arm camera guarantee precise positioning ieee transaction medical robotics bionics vol 2 4 november 2020 573 fig 8 spiralshaped trajectory executed psm1 method tsai ’ method red trajectory represents kinematics ofthe psm1 blue trajectory represents marker identiﬁed 3dspace table iv ac omparison error marker tiptrajectory measured tiptrajectory projection test fig 9 example reprojection da vincicirclersurgical instrument using kinematic reprojection model directly onto camera color image coordination psms experiment proposed method outperforms stateoftheart solution proposed tsai method reach accuracy 1 mm x−yplane dual arm manipulation scenario comparable theintrinsic kinematic precision da vincicircler main drawback solution use rgbd camera limit actual application surgery thinkthat methodology extended setup stan dard surgical endoscope main issue endoscope small baseline stereo camera introduces additional complexity computing depth map reduces depth range view address problem future researchmoreover develop autonomous procedure cal ibration method signiﬁcantly reduce manual error simplify implementation surgical setup